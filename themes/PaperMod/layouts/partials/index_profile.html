<div class="profile">
  {{- with site.Params.profileMode}}
  <div class="profile_inner">

    <!-- FLEX COLUMN: stack row, then buttons -->
    <div style="display: flex; flex-direction: column; align-items: center;">

      <!-- FLEX ROW: the two columns -->
      <div style="display: flex; align-items: flex-start; gap: 2rem; width: 100%; justify-content: center;">

        <!-- Left Column: Image -->
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
          {{- if .imageUrl -}}
            {{- $img := "" }}
            {{- if not (urls.Parse .imageUrl).IsAbs }}
              {{- $img = resources.Get .imageUrl }}
            {{- end }}
            {{- if $img }}
              <img draggable="false" src="{{ $img.Permalink }}"
                   alt="{{ .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
                   height="{{ .imageHeight | default 150 }}" width="{{ .imageWidth | default 150 }}" />
            {{- else }}
              <img draggable="false" src="{{ .imageUrl | absURL }}" 
                   alt="{{ .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
                   height="{{ .imageHeight | default 150 }}" width="{{ .imageWidth | default 150 }}" />
            {{- end }}
          {{- end }}
        </div>

        <!-- Right Column: Titles + Social Icons -->
        <div style="display: flex; flex-direction: column; justify-content: center;">
          <h1 style="margin: 0;">{{ .title | default site.Title | markdownify }}</h1>
          <span style="font-size: 1.2rem; color: var(--content); margin-bottom: 0.75rem; margin-top: 0.75rem; font-weight: 500;">
            {{ .subtitle | markdownify }}<br>{{ .subsubtitle | markdownify }}
          </span>
          {{- partial "social_icons.html" -}}
        </div>
      </div> <!-- end row -->

      <!-- Division line -->
      <hr style="width: 80%; margin: 2rem auto 1.5rem auto; border: 0; border-top: 1.5px solid var(--tertiary)">
      <!-- BUTTONS: centered below both columns -->
      {{- with .buttons }}
      <div class="buttons" style="margin-top: 2rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
        {{- range . }}
        <a class="button" href="{{ trim .url " " }}" rel="noopener" title="{{ .name }}">
          <span class="button-inner">
            {{ .name }}
            {{- if (findRE "://" .url) }}&nbsp;
            <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
              stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="14" width="4">
              <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
              <path d="M15 3h6v6"></path>
              <path d="M10 14L21 3"></path>
            </svg>
            {{- end }}
          </span>
        </a>
        {{- end }}
      </div>
      {{- end }}

    </div> <!-- flex column -->
  </div>
  {{- end}}
</div>
